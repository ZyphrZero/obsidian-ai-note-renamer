# Build Scripts Guide

This directory contains automation scripts for building, packaging, and developing the Smart Workflow Obsidian plugin.

## Quick Start

### Local Development

```bash
# 1. Install dependencies
pnpm i

# 2. Build plugin code
pnpm build

# 3. Build Rust binary for current platform
node scripts/build-rust.js

# 4. Install to Obsidian
pnpm install:dev
```

---

## Script Reference

### build-rust.js - Build Rust Binary

```bash
# Auto-detect current platform and build
node scripts/build-rust.js

# Or via pnpm
pnpm build:rust

# Skip installing build target
node scripts/build-rust.js --skip-install
```

**Output**: `binaries/pty-server-{platform}{ext}` and corresponding `.sha256` file

> **Note**: Local builds only support the current platform. Cross-compilation requires GitHub Actions.

---

### package-plugin.js - Package Plugin

```bash
# Auto-detect current platform and package
pnpm package

# Package and create ZIP
pnpm package -- --zip
```

**Output**: `plugin-package/`

> **Note**: Local packaging only includes the current platform binary. Full release packages are generated by GitHub Actions.

---

### install-dev.js - Interactive Install

```bash
pnpm install:dev
```

Interactive guide to install the plugin to Obsidian, ideal for first-time setup.

---

## Release Process

**Recommended: Use GitHub Actions for automated releases**:

```bash
# 1. Update version numbers (manifest.json and versions.json)

# 2. Commit and create tag
git add .
git commit -m "chore: bump version to x.x.x"
git tag vx.x.x
git push origin vx.x.x

# 3. GitHub Actions will automatically:
#    - Build binaries for all platforms
#    - Package the plugin
#    - Create GitHub Release
```

---

## FAQ

### Missing Binary Files

**Solution**:
```bash
pnpm build:rust
```

---

## Related Documentation

- [PTY Server Documentation](../pty-server/README.md)
- [Main README](../README.md)
- [GitHub Actions Workflow](../.github/workflows/build-rust.yml)
